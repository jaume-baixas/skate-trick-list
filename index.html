<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Skate Tricks PWA</title>
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Skate Tricks">
<link rel="apple-touch-icon" href="icon.png">
<style>
body{font-family:Arial,sans-serif;margin:0;padding:0;background:#071021;color:#e6f0f3}
.wrap{max-width:1100px;margin:18px auto;padding:16px}
header{margin-bottom:16px}
h1{margin:0;font-size:24px}
.controls{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px}
input,select,button{padding:8px;border-radius:8px;border:none}
button{background:#00d1b2;color:#022;font-weight:700;cursor:pointer}
.table-wrap{overflow:auto}
table{border-collapse:collapse;width:100%;min-width:600px}
th,td{padding:8px 10px;border:1px solid rgba(255,255,255,0.05);text-align:center}
td.name{text-align:left}
.resum{margin-top:20px;padding:12px;background:#081425;border-radius:10px}
.progress-bar{height:8px;background:rgba(255,255,255,0.1);border-radius:4px;flex:1;margin-left:8px;overflow:hidden}
.progress-bar-inner{height:100%;background:#00d1b2;width:0%}
</style>
</head>
<body>
<div class="wrap">
<header>
<h1>Skate Tricks</h1>
</header>
<div class="controls">
<input id="newTrick" placeholder="Nou truc">
<select id="newLevel">
<option>Fàcil</option><option>Mitjà</option><option>Difícil</option>
</select>
<button id="addTrickBtn">Afegeix truc</button>
<button id="addWeekBtn">+ Setmana</button>
<button id="exportJson">Exportar JSON</button>
<button id="importJson">Importar JSON</button>
<input type="file" id="fileInput" style="display:none">
</div>
<div class="table-wrap">
<table id="mainTable"></table>
</div>
<div class="resum" id="resumSection"><h2>Resum dels trucs</h2></div>
</div>
<script>
// Dades inicials
let tricks=[],weeks=['Setmana 1'];
// Guardar i carregar localStorage
function save(){localStorage.setItem('skateTricks',JSON.stringify({tricks,weeks}));updateTable();}
function load(){let data=localStorage.getItem('skateTricks');if(data){let obj=JSON.parse(data);tricks=obj.tricks;weeks=obj.weeks;updateTable();}}
function updateTable(){
let table=document.getElementById('mainTable');table.innerHTML='';
let tr=document.createElement('tr');
tr.innerHTML='<th>Truc</th>'+weeks.map(w=>`<th>${w}</th>`).join('');table.appendChild(tr);
tricks.forEach((t,i)=>{
let tr=document.createElement('tr');
tr.innerHTML=`<td class="name">${t.name}</td>`+weeks.map((w,j)=>{
let val=t[j]||'—';
return `<td><select data-trick="${i}" data-week="${j}"><option>—</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select></td>`
}).join('');table.appendChild(tr);
});
document.querySelectorAll('select').forEach(s=>{
s.value=tricks[s.dataset.trick][s.dataset.week]||'—';
s.onchange=function(){let i=this.dataset.trick,j=this.dataset.week;tricks[i][j]=this.value;save();}});
updateSummary();
}
function updateSummary(){
let div=document.getElementById('resumSection');div.innerHTML='<h2>Resum dels trucs</h2>';
tricks.forEach((t,i)=>{let max=0;for(let v of t)if(v!=='—')max=Math.max(max,parseInt(v));let p=(max/5*100)||0;let row=document.createElement('div');row.style.display='flex';row.style.alignItems='center';row.style.marginBottom='6px';row.innerHTML=`<div>${t.name}</div><div class="progress-bar"><div class="progress-bar-inner" style="width:${p}%"></div></div>`;div.appendChild(row);});}
document.getElementById('addTrickBtn').onclick=function(){let n=document.getElementById('newTrick').value.trim();if(n){tricks.push(Array(weeks.length).fill('—'));tricks[tricks.length-1].name=n;save();}};
document.getElementById('addWeekBtn').onclick=function(){weeks.push('Setmana '+(weeks.length+1));tricks.forEach(t=>t.push('—'));save();};
document.getElementById('exportJson').onclick=function(){let data=JSON.stringify({tricks,weeks},null,2);let blob=new Blob([data],{type:'application/json'});let url=URL.createObjectURL(blob);let a=document.createElement('a');a.href=url;a.download='skate_tricks.json';a.click();};
document.getElementById('importJson').onclick=function(){document.getElementById('fileInput').click();};
document.getElementById('fileInput').onchange=function(e){let file=e.target.files[0];let reader=new FileReader();reader.onload=function(){let obj=JSON.parse(reader.result);tricks=obj.tricks||[];weeks=obj.weeks||['Setmana 1'];save();};reader.readAsText(file);};
load();
</script>
<script>
if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js').then(()=>console.log('SW registrat')).catch(console.log);}
</script>
</body>
</html>
